- name: Create random dns label
  set_fact:
    dns_label: "test{{ resource_group | hash('md5') | truncate(16, True, '') + (65535 | random | string) }}"

- name: Create Azure Deploy
  azure_rm_deployment:
    resource_group: "{{ resource_group }}"
    location: "eastus"
    template: "{{ lookup('url', 'https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/101-storage-account-create/azuredeploy.parameters.json', split_lines=False) }}"
    deployment_name: "{{ dns_label }}"
    parameters:
      storageAccountType:
        value: Standard_LRS
  register: output

- name: Dump debug information
  debug:
    var: output
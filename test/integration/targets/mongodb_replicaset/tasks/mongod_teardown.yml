- name: Kill all mongod processes
  command: pkill  -{{ kill_signal }} mongod
  ignore_errors: true

- name: Ensure mongod instances have drained
  wait_for:
    host: localhost
    port: "{{ item }}"
    state: drained
  with_items:
    - 3001
    - 3002
    - 3003

- name: Remove all mongod folders
  file:
    path: "{{ remote_tmp_dir }}/{{ item }}"
    state: absent
  with_items:
    - mongod3001
    - mongod3002
    - mongod3003

- name: Remove all mongod sock files
  shell: rm -Rf /tmp/mongodb*.sock

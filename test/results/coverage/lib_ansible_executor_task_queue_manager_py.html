


<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7" />
    <title>Coverage for lib/ansible/executor/task_queue_manager.py: 69%</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="jquery.hotkeys.js"></script>
    <script type="text/javascript" src="jquery.isonscreen.js"></script>
    <script type="text/javascript" src="coverage_html.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(coverage.pyfile_ready);
    </script>
</head>
<body class="pyfile">

<div id="header">
    <div class="content">
        <h1>Coverage for <b>lib/ansible/executor/task_queue_manager.py</b> :
            <span class="pc_cov">69%</span>
        </h1>

        <img id="keyboard_icon" src="keybd_closed.png" alt="Show keyboard shortcuts" />

        <h2 class="stats">
            218 statements &nbsp;
            <span class="run hide_run shortkey_r button_toggle_run">163 run</span>
            <span class="mis shortkey_m button_toggle_mis">55 missing</span>
            <span class="exc shortkey_x button_toggle_exc">0 excluded</span>

            
                <span class="par run hide_run shortkey_p button_toggle_par">21 partial</span>
            
        </h2>
    </div>
</div>

<div class="help_panel">
    <img id="panel_icon" src="keybd_open.png" alt="Hide keyboard shortcuts" />
    <p class="legend">Hot-keys on this page</p>
    <div>
    <p class="keyhelp">
        <span class="key">r</span>
        <span class="key">m</span>
        <span class="key">x</span>
        <span class="key">p</span> &nbsp; toggle line displays
    </p>
    <p class="keyhelp">
        <span class="key">j</span>
        <span class="key">k</span> &nbsp; next/prev highlighted chunk
    </p>
    <p class="keyhelp">
        <span class="key">0</span> &nbsp; (zero) top of page
    </p>
    <p class="keyhelp">
        <span class="key">1</span> &nbsp; (one) first highlighted chunk
    </p>
    </div>
</div>

<div id="source">
    <table>
        <tr>
            <td class="linenos">
<p id="n1" class="pln"><a href="#n1">1</a></p>
<p id="n2" class="pln"><a href="#n2">2</a></p>
<p id="n3" class="pln"><a href="#n3">3</a></p>
<p id="n4" class="pln"><a href="#n4">4</a></p>
<p id="n5" class="pln"><a href="#n5">5</a></p>
<p id="n6" class="pln"><a href="#n6">6</a></p>
<p id="n7" class="pln"><a href="#n7">7</a></p>
<p id="n8" class="pln"><a href="#n8">8</a></p>
<p id="n9" class="pln"><a href="#n9">9</a></p>
<p id="n10" class="pln"><a href="#n10">10</a></p>
<p id="n11" class="pln"><a href="#n11">11</a></p>
<p id="n12" class="pln"><a href="#n12">12</a></p>
<p id="n13" class="pln"><a href="#n13">13</a></p>
<p id="n14" class="pln"><a href="#n14">14</a></p>
<p id="n15" class="pln"><a href="#n15">15</a></p>
<p id="n16" class="pln"><a href="#n16">16</a></p>
<p id="n17" class="pln"><a href="#n17">17</a></p>
<p id="n18" class="pln"><a href="#n18">18</a></p>
<p id="n19" class="stm run hide_run"><a href="#n19">19</a></p>
<p id="n20" class="stm run hide_run"><a href="#n20">20</a></p>
<p id="n21" class="pln"><a href="#n21">21</a></p>
<p id="n22" class="stm run hide_run"><a href="#n22">22</a></p>
<p id="n23" class="stm run hide_run"><a href="#n23">23</a></p>
<p id="n24" class="stm run hide_run"><a href="#n24">24</a></p>
<p id="n25" class="pln"><a href="#n25">25</a></p>
<p id="n26" class="stm run hide_run"><a href="#n26">26</a></p>
<p id="n27" class="stm run hide_run"><a href="#n27">27</a></p>
<p id="n28" class="stm run hide_run"><a href="#n28">28</a></p>
<p id="n29" class="stm run hide_run"><a href="#n29">29</a></p>
<p id="n30" class="stm run hide_run"><a href="#n30">30</a></p>
<p id="n31" class="stm run hide_run"><a href="#n31">31</a></p>
<p id="n32" class="stm run hide_run"><a href="#n32">32</a></p>
<p id="n33" class="stm run hide_run"><a href="#n33">33</a></p>
<p id="n34" class="stm run hide_run"><a href="#n34">34</a></p>
<p id="n35" class="stm run hide_run"><a href="#n35">35</a></p>
<p id="n36" class="stm run hide_run"><a href="#n36">36</a></p>
<p id="n37" class="stm run hide_run"><a href="#n37">37</a></p>
<p id="n38" class="stm run hide_run"><a href="#n38">38</a></p>
<p id="n39" class="stm run hide_run"><a href="#n39">39</a></p>
<p id="n40" class="stm run hide_run"><a href="#n40">40</a></p>
<p id="n41" class="pln"><a href="#n41">41</a></p>
<p id="n42" class="stm run hide_run"><a href="#n42">42</a></p>
<p id="n43" class="stm run hide_run"><a href="#n43">43</a></p>
<p id="n44" class="stm mis"><a href="#n44">44</a></p>
<p id="n45" class="stm mis"><a href="#n45">45</a></p>
<p id="n46" class="stm mis"><a href="#n46">46</a></p>
<p id="n47" class="pln"><a href="#n47">47</a></p>
<p id="n48" class="pln"><a href="#n48">48</a></p>
<p id="n49" class="stm run hide_run"><a href="#n49">49</a></p>
<p id="n50" class="pln"><a href="#n50">50</a></p>
<p id="n51" class="pln"><a href="#n51">51</a></p>
<p id="n52" class="stm run hide_run"><a href="#n52">52</a></p>
<p id="n53" class="pln"><a href="#n53">53</a></p>
<p id="n54" class="pln"><a href="#n54">54</a></p>
<p id="n55" class="pln"><a href="#n55">55</a></p>
<p id="n56" class="pln"><a href="#n56">56</a></p>
<p id="n57" class="pln"><a href="#n57">57</a></p>
<p id="n58" class="pln"><a href="#n58">58</a></p>
<p id="n59" class="pln"><a href="#n59">59</a></p>
<p id="n60" class="pln"><a href="#n60">60</a></p>
<p id="n61" class="pln"><a href="#n61">61</a></p>
<p id="n62" class="pln"><a href="#n62">62</a></p>
<p id="n63" class="pln"><a href="#n63">63</a></p>
<p id="n64" class="stm run hide_run"><a href="#n64">64</a></p>
<p id="n65" class="stm run hide_run"><a href="#n65">65</a></p>
<p id="n66" class="stm run hide_run"><a href="#n66">66</a></p>
<p id="n67" class="stm run hide_run"><a href="#n67">67</a></p>
<p id="n68" class="stm run hide_run"><a href="#n68">68</a></p>
<p id="n69" class="stm run hide_run"><a href="#n69">69</a></p>
<p id="n70" class="pln"><a href="#n70">70</a></p>
<p id="n71" class="stm run hide_run"><a href="#n71">71</a></p>
<p id="n72" class="pln"><a href="#n72">72</a></p>
<p id="n73" class="stm run hide_run"><a href="#n73">73</a></p>
<p id="n74" class="stm run hide_run"><a href="#n74">74</a></p>
<p id="n75" class="stm run hide_run"><a href="#n75">75</a></p>
<p id="n76" class="stm run hide_run"><a href="#n76">76</a></p>
<p id="n77" class="stm run hide_run"><a href="#n77">77</a></p>
<p id="n78" class="stm run hide_run"><a href="#n78">78</a></p>
<p id="n79" class="stm run hide_run"><a href="#n79">79</a></p>
<p id="n80" class="stm run hide_run"><a href="#n80">80</a></p>
<p id="n81" class="stm run hide_run"><a href="#n81">81</a></p>
<p id="n82" class="pln"><a href="#n82">82</a></p>
<p id="n83" class="stm run hide_run"><a href="#n83">83</a></p>
<p id="n84" class="stm run hide_run"><a href="#n84">84</a></p>
<p id="n85" class="stm run hide_run"><a href="#n85">85</a></p>
<p id="n86" class="pln"><a href="#n86">86</a></p>
<p id="n87" class="pln"><a href="#n87">87</a></p>
<p id="n88" class="stm par run hide_run"><a href="#n88">88</a></p>
<p id="n89" class="stm mis"><a href="#n89">89</a></p>
<p id="n90" class="stm mis"><a href="#n90">90</a></p>
<p id="n91" class="stm mis"><a href="#n91">91</a></p>
<p id="n92" class="pln"><a href="#n92">92</a></p>
<p id="n93" class="pln"><a href="#n93">93</a></p>
<p id="n94" class="stm run hide_run"><a href="#n94">94</a></p>
<p id="n95" class="pln"><a href="#n95">95</a></p>
<p id="n96" class="pln"><a href="#n96">96</a></p>
<p id="n97" class="stm run hide_run"><a href="#n97">97</a></p>
<p id="n98" class="stm run hide_run"><a href="#n98">98</a></p>
<p id="n99" class="pln"><a href="#n99">99</a></p>
<p id="n100" class="pln"><a href="#n100">100</a></p>
<p id="n101" class="stm run hide_run"><a href="#n101">101</a></p>
<p id="n102" class="stm run hide_run"><a href="#n102">102</a></p>
<p id="n103" class="pln"><a href="#n103">103</a></p>
<p id="n104" class="stm run hide_run"><a href="#n104">104</a></p>
<p id="n105" class="stm run hide_run"><a href="#n105">105</a></p>
<p id="n106" class="stm mis"><a href="#n106">106</a></p>
<p id="n107" class="stm mis"><a href="#n107">107</a></p>
<p id="n108" class="pln"><a href="#n108">108</a></p>
<p id="n109" class="pln"><a href="#n109">109</a></p>
<p id="n110" class="pln"><a href="#n110">110</a></p>
<p id="n111" class="stm run hide_run"><a href="#n111">111</a></p>
<p id="n112" class="pln"><a href="#n112">112</a></p>
<p id="n113" class="stm run hide_run"><a href="#n113">113</a></p>
<p id="n114" class="stm run hide_run"><a href="#n114">114</a></p>
<p id="n115" class="pln"><a href="#n115">115</a></p>
<p id="n116" class="stm run hide_run"><a href="#n116">116</a></p>
<p id="n117" class="stm run hide_run"><a href="#n117">117</a></p>
<p id="n118" class="pln"><a href="#n118">118</a></p>
<p id="n119" class="stm run hide_run"><a href="#n119">119</a></p>
<p id="n120" class="pln"><a href="#n120">120</a></p>
<p id="n121" class="pln"><a href="#n121">121</a></p>
<p id="n122" class="pln"><a href="#n122">122</a></p>
<p id="n123" class="pln"><a href="#n123">123</a></p>
<p id="n124" class="pln"><a href="#n124">124</a></p>
<p id="n125" class="pln"><a href="#n125">125</a></p>
<p id="n126" class="pln"><a href="#n126">126</a></p>
<p id="n127" class="pln"><a href="#n127">127</a></p>
<p id="n128" class="stm run hide_run"><a href="#n128">128</a></p>
<p id="n129" class="stm run hide_run"><a href="#n129">129</a></p>
<p id="n130" class="pln"><a href="#n130">130</a></p>
<p id="n131" class="stm run hide_run"><a href="#n131">131</a></p>
<p id="n132" class="stm mis"><a href="#n132">132</a></p>
<p id="n133" class="stm mis"><a href="#n133">133</a></p>
<p id="n134" class="stm mis"><a href="#n134">134</a></p>
<p id="n135" class="stm mis"><a href="#n135">135</a></p>
<p id="n136" class="pln"><a href="#n136">136</a></p>
<p id="n137" class="stm mis"><a href="#n137">137</a></p>
<p id="n138" class="stm mis"><a href="#n138">138</a></p>
<p id="n139" class="pln"><a href="#n139">139</a></p>
<p id="n140" class="stm run hide_run"><a href="#n140">140</a></p>
<p id="n141" class="stm par run hide_run"><a href="#n141">141</a></p>
<p id="n142" class="stm mis"><a href="#n142">142</a></p>
<p id="n143" class="pln"><a href="#n143">143</a></p>
<p id="n144" class="stm run hide_run"><a href="#n144">144</a></p>
<p id="n145" class="pln"><a href="#n145">145</a></p>
<p id="n146" class="stm run hide_run"><a href="#n146">146</a></p>
<p id="n147" class="stm par run hide_run"><a href="#n147">147</a></p>
<p id="n148" class="stm mis"><a href="#n148">148</a></p>
<p id="n149" class="stm mis"><a href="#n149">149</a></p>
<p id="n150" class="stm mis"><a href="#n150">150</a></p>
<p id="n151" class="stm mis"><a href="#n151">151</a></p>
<p id="n152" class="stm mis"><a href="#n152">152</a></p>
<p id="n153" class="stm mis"><a href="#n153">153</a></p>
<p id="n154" class="stm mis"><a href="#n154">154</a></p>
<p id="n155" class="stm mis"><a href="#n155">155</a></p>
<p id="n156" class="stm mis"><a href="#n156">156</a></p>
<p id="n157" class="stm mis"><a href="#n157">157</a></p>
<p id="n158" class="stm mis"><a href="#n158">158</a></p>
<p id="n159" class="stm mis"><a href="#n159">159</a></p>
<p id="n160" class="pln"><a href="#n160">160</a></p>
<p id="n161" class="stm run hide_run"><a href="#n161">161</a></p>
<p id="n162" class="pln"><a href="#n162">162</a></p>
<p id="n163" class="pln"><a href="#n163">163</a></p>
<p id="n164" class="pln"><a href="#n164">164</a></p>
<p id="n165" class="pln"><a href="#n165">165</a></p>
<p id="n166" class="pln"><a href="#n166">166</a></p>
<p id="n167" class="pln"><a href="#n167">167</a></p>
<p id="n168" class="stm par run hide_run"><a href="#n168">168</a></p>
<p id="n169" class="stm mis"><a href="#n169">169</a></p>
<p id="n170" class="pln"><a href="#n170">170</a></p>
<p id="n171" class="stm run hide_run"><a href="#n171">171</a></p>
<p id="n172" class="stm par run hide_run"><a href="#n172">172</a></p>
<p id="n173" class="stm run hide_run"><a href="#n173">173</a></p>
<p id="n174" class="pln"><a href="#n174">174</a></p>
<p id="n175" class="stm par run hide_run"><a href="#n175">175</a></p>
<p id="n176" class="stm mis"><a href="#n176">176</a></p>
<p id="n177" class="stm par run hide_run"><a href="#n177">177</a></p>
<p id="n178" class="stm par run hide_run"><a href="#n178">178</a></p>
<p id="n179" class="stm mis"><a href="#n179">179</a></p>
<p id="n180" class="pln"><a href="#n180">180</a></p>
<p id="n181" class="stm run hide_run"><a href="#n181">181</a></p>
<p id="n182" class="stm run hide_run"><a href="#n182">182</a></p>
<p id="n183" class="stm run hide_run"><a href="#n183">183</a></p>
<p id="n184" class="stm mis"><a href="#n184">184</a></p>
<p id="n185" class="stm mis"><a href="#n185">185</a></p>
<p id="n186" class="pln"><a href="#n186">186</a></p>
<p id="n187" class="pln"><a href="#n187">187</a></p>
<p id="n188" class="stm run hide_run"><a href="#n188">188</a></p>
<p id="n189" class="pln"><a href="#n189">189</a></p>
<p id="n190" class="stm mis"><a href="#n190">190</a></p>
<p id="n191" class="pln"><a href="#n191">191</a></p>
<p id="n192" class="stm run hide_run"><a href="#n192">192</a></p>
<p id="n193" class="stm run hide_run"><a href="#n193">193</a></p>
<p id="n194" class="stm run hide_run"><a href="#n194">194</a></p>
<p id="n195" class="stm run hide_run"><a href="#n195">195</a></p>
<p id="n196" class="stm run hide_run"><a href="#n196">196</a></p>
<p id="n197" class="pln"><a href="#n197">197</a></p>
<p id="n198" class="stm par run hide_run"><a href="#n198">198</a></p>
<p id="n199" class="stm mis"><a href="#n199">199</a></p>
<p id="n200" class="stm mis"><a href="#n200">200</a></p>
<p id="n201" class="stm par run hide_run"><a href="#n201">201</a></p>
<p id="n202" class="pln"><a href="#n202">202</a></p>
<p id="n203" class="stm mis"><a href="#n203">203</a></p>
<p id="n204" class="stm run hide_run"><a href="#n204">204</a></p>
<p id="n205" class="pln"><a href="#n205">205</a></p>
<p id="n206" class="pln"><a href="#n206">206</a></p>
<p id="n207" class="stm run hide_run"><a href="#n207">207</a></p>
<p id="n208" class="pln"><a href="#n208">208</a></p>
<p id="n209" class="stm run hide_run"><a href="#n209">209</a></p>
<p id="n210" class="stm run hide_run"><a href="#n210">210</a></p>
<p id="n211" class="stm run hide_run"><a href="#n211">211</a></p>
<p id="n212" class="stm mis"><a href="#n212">212</a></p>
<p id="n213" class="stm mis"><a href="#n213">213</a></p>
<p id="n214" class="pln"><a href="#n214">214</a></p>
<p id="n215" class="pln"><a href="#n215">215</a></p>
<p id="n216" class="stm run hide_run"><a href="#n216">216</a></p>
<p id="n217" class="pln"><a href="#n217">217</a></p>
<p id="n218" class="stm run hide_run"><a href="#n218">218</a></p>
<p id="n219" class="pln"><a href="#n219">219</a></p>
<p id="n220" class="stm run hide_run"><a href="#n220">220</a></p>
<p id="n221" class="pln"><a href="#n221">221</a></p>
<p id="n222" class="pln"><a href="#n222">222</a></p>
<p id="n223" class="pln"><a href="#n223">223</a></p>
<p id="n224" class="pln"><a href="#n224">224</a></p>
<p id="n225" class="pln"><a href="#n225">225</a></p>
<p id="n226" class="pln"><a href="#n226">226</a></p>
<p id="n227" class="pln"><a href="#n227">227</a></p>
<p id="n228" class="pln"><a href="#n228">228</a></p>
<p id="n229" class="stm par run hide_run"><a href="#n229">229</a></p>
<p id="n230" class="stm mis"><a href="#n230">230</a></p>
<p id="n231" class="pln"><a href="#n231">231</a></p>
<p id="n232" class="stm run hide_run"><a href="#n232">232</a></p>
<p id="n233" class="stm run hide_run"><a href="#n233">233</a></p>
<p id="n234" class="stm run hide_run"><a href="#n234">234</a></p>
<p id="n235" class="pln"><a href="#n235">235</a></p>
<p id="n236" class="stm run hide_run"><a href="#n236">236</a></p>
<p id="n237" class="stm run hide_run"><a href="#n237">237</a></p>
<p id="n238" class="stm run hide_run"><a href="#n238">238</a></p>
<p id="n239" class="pln"><a href="#n239">239</a></p>
<p id="n240" class="stm run hide_run"><a href="#n240">240</a></p>
<p id="n241" class="pln"><a href="#n241">241</a></p>
<p id="n242" class="pln"><a href="#n242">242</a></p>
<p id="n243" class="pln"><a href="#n243">243</a></p>
<p id="n244" class="pln"><a href="#n244">244</a></p>
<p id="n245" class="pln"><a href="#n245">245</a></p>
<p id="n246" class="stm run hide_run"><a href="#n246">246</a></p>
<p id="n247" class="stm run hide_run"><a href="#n247">247</a></p>
<p id="n248" class="stm par run hide_run"><a href="#n248">248</a></p>
<p id="n249" class="stm run hide_run"><a href="#n249">249</a></p>
<p id="n250" class="pln"><a href="#n250">250</a></p>
<p id="n251" class="stm run hide_run"><a href="#n251">251</a></p>
<p id="n252" class="pln"><a href="#n252">252</a></p>
<p id="n253" class="pln"><a href="#n253">253</a></p>
<p id="n254" class="stm run hide_run"><a href="#n254">254</a></p>
<p id="n255" class="pln"><a href="#n255">255</a></p>
<p id="n256" class="pln"><a href="#n256">256</a></p>
<p id="n257" class="stm run hide_run"><a href="#n257">257</a></p>
<p id="n258" class="pln"><a href="#n258">258</a></p>
<p id="n259" class="pln"><a href="#n259">259</a></p>
<p id="n260" class="pln"><a href="#n260">260</a></p>
<p id="n261" class="pln"><a href="#n261">261</a></p>
<p id="n262" class="pln"><a href="#n262">262</a></p>
<p id="n263" class="pln"><a href="#n263">263</a></p>
<p id="n264" class="pln"><a href="#n264">264</a></p>
<p id="n265" class="pln"><a href="#n265">265</a></p>
<p id="n266" class="pln"><a href="#n266">266</a></p>
<p id="n267" class="stm run hide_run"><a href="#n267">267</a></p>
<p id="n268" class="pln"><a href="#n268">268</a></p>
<p id="n269" class="pln"><a href="#n269">269</a></p>
<p id="n270" class="stm run hide_run"><a href="#n270">270</a></p>
<p id="n271" class="stm par run hide_run"><a href="#n271">271</a></p>
<p id="n272" class="stm mis"><a href="#n272">272</a></p>
<p id="n273" class="pln"><a href="#n273">273</a></p>
<p id="n274" class="pln"><a href="#n274">274</a></p>
<p id="n275" class="pln"><a href="#n275">275</a></p>
<p id="n276" class="pln"><a href="#n276">276</a></p>
<p id="n277" class="pln"><a href="#n277">277</a></p>
<p id="n278" class="stm par run hide_run"><a href="#n278">278</a></p>
<p id="n279" class="stm mis"><a href="#n279">279</a></p>
<p id="n280" class="stm mis"><a href="#n280">280</a></p>
<p id="n281" class="pln"><a href="#n281">281</a></p>
<p id="n282" class="stm run hide_run"><a href="#n282">282</a></p>
<p id="n283" class="pln"><a href="#n283">283</a></p>
<p id="n284" class="pln"><a href="#n284">284</a></p>
<p id="n285" class="pln"><a href="#n285">285</a></p>
<p id="n286" class="pln"><a href="#n286">286</a></p>
<p id="n287" class="stm par run hide_run"><a href="#n287">287</a></p>
<p id="n288" class="stm mis"><a href="#n288">288</a></p>
<p id="n289" class="pln"><a href="#n289">289</a></p>
<p id="n290" class="pln"><a href="#n290">290</a></p>
<p id="n291" class="stm run hide_run"><a href="#n291">291</a></p>
<p id="n292" class="pln"><a href="#n292">292</a></p>
<p id="n293" class="pln"><a href="#n293">293</a></p>
<p id="n294" class="stm run hide_run"><a href="#n294">294</a></p>
<p id="n295" class="stm run hide_run"><a href="#n295">295</a></p>
<p id="n296" class="pln"><a href="#n296">296</a></p>
<p id="n297" class="stm run hide_run"><a href="#n297">297</a></p>
<p id="n298" class="stm run hide_run"><a href="#n298">298</a></p>
<p id="n299" class="stm run hide_run"><a href="#n299">299</a></p>
<p id="n300" class="pln"><a href="#n300">300</a></p>
<p id="n301" class="stm run hide_run"><a href="#n301">301</a></p>
<p id="n302" class="stm run hide_run"><a href="#n302">302</a></p>
<p id="n303" class="stm run hide_run"><a href="#n303">303</a></p>
<p id="n304" class="stm run hide_run"><a href="#n304">304</a></p>
<p id="n305" class="stm run hide_run"><a href="#n305">305</a></p>
<p id="n306" class="pln"><a href="#n306">306</a></p>
<p id="n307" class="stm run hide_run"><a href="#n307">307</a></p>
<p id="n308" class="stm par run hide_run"><a href="#n308">308</a></p>
<p id="n309" class="stm run hide_run"><a href="#n309">309</a></p>
<p id="n310" class="stm par run hide_run"><a href="#n310">310</a></p>
<p id="n311" class="stm mis"><a href="#n311">311</a></p>
<p id="n312" class="stm mis"><a href="#n312">312</a></p>
<p id="n313" class="stm mis"><a href="#n313">313</a></p>
<p id="n314" class="stm mis"><a href="#n314">314</a></p>
<p id="n315" class="pln"><a href="#n315">315</a></p>
<p id="n316" class="stm run hide_run"><a href="#n316">316</a></p>
<p id="n317" class="stm run hide_run"><a href="#n317">317</a></p>
<p id="n318" class="pln"><a href="#n318">318</a></p>
<p id="n319" class="stm run hide_run"><a href="#n319">319</a></p>
<p id="n320" class="stm run hide_run"><a href="#n320">320</a></p>
<p id="n321" class="pln"><a href="#n321">321</a></p>
<p id="n322" class="stm run hide_run"><a href="#n322">322</a></p>
<p id="n323" class="stm run hide_run"><a href="#n323">323</a></p>
<p id="n324" class="pln"><a href="#n324">324</a></p>
<p id="n325" class="stm run hide_run"><a href="#n325">325</a></p>
<p id="n326" class="stm run hide_run"><a href="#n326">326</a></p>
<p id="n327" class="pln"><a href="#n327">327</a></p>
<p id="n328" class="stm run hide_run"><a href="#n328">328</a></p>
<p id="n329" class="stm run hide_run"><a href="#n329">329</a></p>
<p id="n330" class="pln"><a href="#n330">330</a></p>
<p id="n331" class="stm run hide_run"><a href="#n331">331</a></p>
<p id="n332" class="stm run hide_run"><a href="#n332">332</a></p>
<p id="n333" class="pln"><a href="#n333">333</a></p>
<p id="n334" class="stm run hide_run"><a href="#n334">334</a></p>
<p id="n335" class="pln"><a href="#n335">335</a></p>
<p id="n336" class="pln"><a href="#n336">336</a></p>
<p id="n337" class="pln"><a href="#n337">337</a></p>
<p id="n338" class="pln"><a href="#n338">338</a></p>
<p id="n339" class="stm run hide_run"><a href="#n339">339</a></p>
<p id="n340" class="stm run hide_run"><a href="#n340">340</a></p>
<p id="n341" class="stm par run hide_run"><a href="#n341">341</a></p>
<p id="n342" class="stm mis"><a href="#n342">342</a></p>
<p id="n343" class="stm mis"><a href="#n343">343</a></p>
<p id="n344" class="stm run hide_run"><a href="#n344">344</a></p>
<p id="n345" class="pln"><a href="#n345">345</a></p>
<p id="n346" class="stm run hide_run"><a href="#n346">346</a></p>
<p id="n347" class="stm run hide_run"><a href="#n347">347</a></p>
<p id="n348" class="pln"><a href="#n348">348</a></p>
<p id="n349" class="pln"><a href="#n349">349</a></p>
<p id="n350" class="stm run hide_run"><a href="#n350">350</a></p>
<p id="n351" class="stm run hide_run"><a href="#n351">351</a></p>
<p id="n352" class="pln"><a href="#n352">352</a></p>
<p id="n353" class="pln"><a href="#n353">353</a></p>
<p id="n354" class="stm run hide_run"><a href="#n354">354</a></p>
<p id="n355" class="stm run hide_run"><a href="#n355">355</a></p>
<p id="n356" class="stm run hide_run"><a href="#n356">356</a></p>
<p id="n357" class="stm par run hide_run"><a href="#n357">357</a></p>
<p id="n358" class="stm mis"><a href="#n358">358</a></p>
<p id="n359" class="stm par run hide_run"><a href="#n359">359</a></p>
<p id="n360" class="stm run hide_run"><a href="#n360">360</a></p>
<p id="n361" class="pln"><a href="#n361">361</a></p>
<p id="n362" class="pln"><a href="#n362">362</a></p>
<p id="n363" class="stm run hide_run"><a href="#n363">363</a></p>
<p id="n364" class="stm run hide_run"><a href="#n364">364</a></p>
<p id="n365" class="pln"><a href="#n365">365</a></p>
<p id="n366" class="stm run hide_run"><a href="#n366">366</a></p>
<p id="n367" class="stm run hide_run"><a href="#n367">367</a></p>
<p id="n368" class="pln"><a href="#n368">368</a></p>
<p id="n369" class="pln"><a href="#n369">369</a></p>
<p id="n370" class="pln"><a href="#n370">370</a></p>
<p id="n371" class="stm run hide_run"><a href="#n371">371</a></p>
<p id="n372" class="pln"><a href="#n372">372</a></p>
<p id="n373" class="stm run hide_run"><a href="#n373">373</a></p>
<p id="n374" class="stm run hide_run"><a href="#n374">374</a></p>
<p id="n375" class="stm run hide_run"><a href="#n375">375</a></p>
<p id="n376" class="stm mis"><a href="#n376">376</a></p>
<p id="n377" class="pln"><a href="#n377">377</a></p>
<p id="n378" class="stm mis"><a href="#n378">378</a></p>
<p id="n379" class="stm mis"><a href="#n379">379</a></p>
<p id="n380" class="stm mis"><a href="#n380">380</a></p>
<p id="n381" class="stm mis"><a href="#n381">381</a></p>

            </td>
            <td class="text">
<p id="t1" class="pln"><span class="com"># (c) 2012-2014, Michael DeHaan &lt;michael.dehaan@gmail.com></span><span class="strut">&nbsp;</span></p>
<p id="t2" class="pln"><span class="com">#</span><span class="strut">&nbsp;</span></p>
<p id="t3" class="pln"><span class="com"># This file is part of Ansible</span><span class="strut">&nbsp;</span></p>
<p id="t4" class="pln"><span class="com">#</span><span class="strut">&nbsp;</span></p>
<p id="t5" class="pln"><span class="com"># Ansible is free software: you can redistribute it and/or modify</span><span class="strut">&nbsp;</span></p>
<p id="t6" class="pln"><span class="com"># it under the terms of the GNU General Public License as published by</span><span class="strut">&nbsp;</span></p>
<p id="t7" class="pln"><span class="com"># the Free Software Foundation, either version 3 of the License, or</span><span class="strut">&nbsp;</span></p>
<p id="t8" class="pln"><span class="com"># (at your option) any later version.</span><span class="strut">&nbsp;</span></p>
<p id="t9" class="pln"><span class="com">#</span><span class="strut">&nbsp;</span></p>
<p id="t10" class="pln"><span class="com"># Ansible is distributed in the hope that it will be useful,</span><span class="strut">&nbsp;</span></p>
<p id="t11" class="pln"><span class="com"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span><span class="strut">&nbsp;</span></p>
<p id="t12" class="pln"><span class="com"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><span class="strut">&nbsp;</span></p>
<p id="t13" class="pln"><span class="com"># GNU General Public License for more details.</span><span class="strut">&nbsp;</span></p>
<p id="t14" class="pln"><span class="com">#</span><span class="strut">&nbsp;</span></p>
<p id="t15" class="pln"><span class="com"># You should have received a copy of the GNU General Public License</span><span class="strut">&nbsp;</span></p>
<p id="t16" class="pln"><span class="com"># along with Ansible.  If not, see &lt;http://www.gnu.org/licenses/>.</span><span class="strut">&nbsp;</span></p>
<p id="t17" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t18" class="pln"><span class="com"># Make coding more python3-ish</span><span class="strut">&nbsp;</span></p>
<p id="t19" class="stm run hide_run"><span class="key">from</span> <span class="nam">__future__</span> <span class="key">import</span> <span class="op">(</span><span class="nam">absolute_import</span><span class="op">,</span> <span class="nam">division</span><span class="op">,</span> <span class="nam">print_function</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t20" class="stm run hide_run"><span class="nam">__metaclass__</span> <span class="op">=</span> <span class="nam">type</span><span class="strut">&nbsp;</span></p>
<p id="t21" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t22" class="stm run hide_run"><span class="key">import</span> <span class="nam">multiprocessing</span><span class="strut">&nbsp;</span></p>
<p id="t23" class="stm run hide_run"><span class="key">import</span> <span class="nam">os</span><span class="strut">&nbsp;</span></p>
<p id="t24" class="stm run hide_run"><span class="key">import</span> <span class="nam">tempfile</span><span class="strut">&nbsp;</span></p>
<p id="t25" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t26" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span> <span class="key">import</span> <span class="nam">constants</span> <span class="key">as</span> <span class="nam">C</span><span class="strut">&nbsp;</span></p>
<p id="t27" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">errors</span> <span class="key">import</span> <span class="nam">AnsibleError</span><span class="strut">&nbsp;</span></p>
<p id="t28" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">executor</span><span class="op">.</span><span class="nam">play_iterator</span> <span class="key">import</span> <span class="nam">PlayIterator</span><span class="strut">&nbsp;</span></p>
<p id="t29" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">executor</span><span class="op">.</span><span class="nam">stats</span> <span class="key">import</span> <span class="nam">AggregateStats</span><span class="strut">&nbsp;</span></p>
<p id="t30" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">executor</span><span class="op">.</span><span class="nam">task_result</span> <span class="key">import</span> <span class="nam">TaskResult</span><span class="strut">&nbsp;</span></p>
<p id="t31" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">module_utils</span><span class="op">.</span><span class="nam">six</span> <span class="key">import</span> <span class="nam">string_types</span><span class="strut">&nbsp;</span></p>
<p id="t32" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">module_utils</span><span class="op">.</span><span class="nam">_text</span> <span class="key">import</span> <span class="nam">to_text</span><span class="op">,</span> <span class="nam">to_native</span><span class="strut">&nbsp;</span></p>
<p id="t33" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">playbook</span><span class="op">.</span><span class="nam">block</span> <span class="key">import</span> <span class="nam">Block</span><span class="strut">&nbsp;</span></p>
<p id="t34" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">playbook</span><span class="op">.</span><span class="nam">play_context</span> <span class="key">import</span> <span class="nam">PlayContext</span><span class="strut">&nbsp;</span></p>
<p id="t35" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">plugins</span><span class="op">.</span><span class="nam">loader</span> <span class="key">import</span> <span class="nam">callback_loader</span><span class="op">,</span> <span class="nam">strategy_loader</span><span class="op">,</span> <span class="nam">module_loader</span><span class="strut">&nbsp;</span></p>
<p id="t36" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">plugins</span><span class="op">.</span><span class="nam">callback</span> <span class="key">import</span> <span class="nam">CallbackBase</span><span class="strut">&nbsp;</span></p>
<p id="t37" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">template</span> <span class="key">import</span> <span class="nam">Templar</span><span class="strut">&nbsp;</span></p>
<p id="t38" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">utils</span><span class="op">.</span><span class="nam">helpers</span> <span class="key">import</span> <span class="nam">pct_to_int</span><span class="strut">&nbsp;</span></p>
<p id="t39" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">vars</span><span class="op">.</span><span class="nam">hostvars</span> <span class="key">import</span> <span class="nam">HostVars</span><span class="strut">&nbsp;</span></p>
<p id="t40" class="stm run hide_run"><span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">vars</span><span class="op">.</span><span class="nam">reserved</span> <span class="key">import</span> <span class="nam">warn_if_reserved</span><span class="strut">&nbsp;</span></p>
<p id="t41" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t42" class="stm run hide_run"><span class="key">try</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t43" class="stm run hide_run">    <span class="key">from</span> <span class="nam">__main__</span> <span class="key">import</span> <span class="nam">display</span><span class="strut">&nbsp;</span></p>
<p id="t44" class="stm mis"><span class="key">except</span> <span class="nam">ImportError</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t45" class="stm mis">    <span class="key">from</span> <span class="nam">ansible</span><span class="op">.</span><span class="nam">utils</span><span class="op">.</span><span class="nam">display</span> <span class="key">import</span> <span class="nam">Display</span><span class="strut">&nbsp;</span></p>
<p id="t46" class="stm mis">    <span class="nam">display</span> <span class="op">=</span> <span class="nam">Display</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t47" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t48" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t49" class="stm run hide_run"><span class="nam">__all__</span> <span class="op">=</span> <span class="op">[</span><span class="str">'TaskQueueManager'</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t50" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t51" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t52" class="stm run hide_run"><span class="key">class</span> <span class="nam">TaskQueueManager</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t53" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t54" class="pln">    <span class="str">'''</span><span class="strut">&nbsp;</span></p>
<p id="t55" class="pln"><span class="str">    This class handles the multiprocessing requirements of Ansible by</span><span class="strut">&nbsp;</span></p>
<p id="t56" class="pln"><span class="str">    creating a pool of worker forks, a result handler fork, and a</span><span class="strut">&nbsp;</span></p>
<p id="t57" class="pln"><span class="str">    manager object with shared datastructures/queues for coordinating</span><span class="strut">&nbsp;</span></p>
<p id="t58" class="pln"><span class="str">    work between all processes.</span><span class="strut">&nbsp;</span></p>
<p id="t59" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t60" class="pln"><span class="str">    The queue manager is responsible for loading the play strategy plugin,</span><span class="strut">&nbsp;</span></p>
<p id="t61" class="pln"><span class="str">    which dispatches the Play's tasks to hosts.</span><span class="strut">&nbsp;</span></p>
<p id="t62" class="pln"><span class="str">    '''</span><span class="strut">&nbsp;</span></p>
<p id="t63" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t64" class="stm run hide_run">    <span class="nam">RUN_OK</span> <span class="op">=</span> <span class="num">0</span><span class="strut">&nbsp;</span></p>
<p id="t65" class="stm run hide_run">    <span class="nam">RUN_ERROR</span> <span class="op">=</span> <span class="num">1</span><span class="strut">&nbsp;</span></p>
<p id="t66" class="stm run hide_run">    <span class="nam">RUN_FAILED_HOSTS</span> <span class="op">=</span> <span class="num">2</span><span class="strut">&nbsp;</span></p>
<p id="t67" class="stm run hide_run">    <span class="nam">RUN_UNREACHABLE_HOSTS</span> <span class="op">=</span> <span class="num">4</span><span class="strut">&nbsp;</span></p>
<p id="t68" class="stm run hide_run">    <span class="nam">RUN_FAILED_BREAK_PLAY</span> <span class="op">=</span> <span class="num">8</span><span class="strut">&nbsp;</span></p>
<p id="t69" class="stm run hide_run">    <span class="nam">RUN_UNKNOWN_ERROR</span> <span class="op">=</span> <span class="num">255</span><span class="strut">&nbsp;</span></p>
<p id="t70" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t71" class="stm run hide_run">    <span class="key">def</span> <span class="nam">__init__</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">inventory</span><span class="op">,</span> <span class="nam">variable_manager</span><span class="op">,</span> <span class="nam">loader</span><span class="op">,</span> <span class="nam">options</span><span class="op">,</span> <span class="nam">passwords</span><span class="op">,</span> <span class="nam">stdout_callback</span><span class="op">=</span><span class="nam">None</span><span class="op">,</span> <span class="nam">run_additional_callbacks</span><span class="op">=</span><span class="nam">True</span><span class="op">,</span> <span class="nam">run_tree</span><span class="op">=</span><span class="nam">False</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t72" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t73" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_inventory</span> <span class="op">=</span> <span class="nam">inventory</span><span class="strut">&nbsp;</span></p>
<p id="t74" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_variable_manager</span> <span class="op">=</span> <span class="nam">variable_manager</span><span class="strut">&nbsp;</span></p>
<p id="t75" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_loader</span> <span class="op">=</span> <span class="nam">loader</span><span class="strut">&nbsp;</span></p>
<p id="t76" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_options</span> <span class="op">=</span> <span class="nam">options</span><span class="strut">&nbsp;</span></p>
<p id="t77" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_stats</span> <span class="op">=</span> <span class="nam">AggregateStats</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t78" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">passwords</span> <span class="op">=</span> <span class="nam">passwords</span><span class="strut">&nbsp;</span></p>
<p id="t79" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span> <span class="op">=</span> <span class="nam">stdout_callback</span><span class="strut">&nbsp;</span></p>
<p id="t80" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_run_additional_callbacks</span> <span class="op">=</span> <span class="nam">run_additional_callbacks</span><span class="strut">&nbsp;</span></p>
<p id="t81" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_run_tree</span> <span class="op">=</span> <span class="nam">run_tree</span><span class="strut">&nbsp;</span></p>
<p id="t82" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t83" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_callbacks_loaded</span> <span class="op">=</span> <span class="nam">False</span><span class="strut">&nbsp;</span></p>
<p id="t84" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_callback_plugins</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t85" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_start_at_done</span> <span class="op">=</span> <span class="nam">False</span><span class="strut">&nbsp;</span></p>
<p id="t86" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t87" class="pln">        <span class="com"># make sure any module paths (if specified) are added to the module_loader</span><span class="strut">&nbsp;</span></p>
<p id="t88" class="stm par run hide_run"><span class="annotate short">88&#x202F;&#x219B;&#x202F;89</span><span class="annotate long">line 88 didn't jump to line 89, because the condition on line 88 was never true</span>        <span class="key">if</span> <span class="nam">options</span><span class="op">.</span><span class="nam">module_path</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t89" class="stm mis">            <span class="key">for</span> <span class="nam">path</span> <span class="key">in</span> <span class="nam">options</span><span class="op">.</span><span class="nam">module_path</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t90" class="stm mis">                <span class="key">if</span> <span class="nam">path</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t91" class="stm mis">                    <span class="nam">module_loader</span><span class="op">.</span><span class="nam">add_directory</span><span class="op">(</span><span class="nam">path</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t92" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t93" class="pln">        <span class="com"># a special flag to help us exit cleanly</span><span class="strut">&nbsp;</span></p>
<p id="t94" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_terminated</span> <span class="op">=</span> <span class="nam">False</span><span class="strut">&nbsp;</span></p>
<p id="t95" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t96" class="pln">        <span class="com"># this dictionary is used to keep track of notified handlers</span><span class="strut">&nbsp;</span></p>
<p id="t97" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_notified_handlers</span> <span class="op">=</span> <span class="nam">dict</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t98" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_listening_handlers</span> <span class="op">=</span> <span class="nam">dict</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t99" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t100" class="pln">        <span class="com"># dictionaries to keep track of failed/unreachable hosts</span><span class="strut">&nbsp;</span></p>
<p id="t101" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_failed_hosts</span> <span class="op">=</span> <span class="nam">dict</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t102" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_unreachable_hosts</span> <span class="op">=</span> <span class="nam">dict</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t103" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t104" class="stm run hide_run">        <span class="key">try</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t105" class="stm run hide_run">            <span class="nam">self</span><span class="op">.</span><span class="nam">_final_q</span> <span class="op">=</span> <span class="nam">multiprocessing</span><span class="op">.</span><span class="nam">Queue</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t106" class="stm mis">        <span class="key">except</span> <span class="nam">OSError</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t107" class="stm mis">            <span class="key">raise</span> <span class="nam">AnsibleError</span><span class="op">(</span><span class="str">"Unable to use multiprocessing, this is normally caused by lack of access to /dev/shm: %s"</span> <span class="op">%</span> <span class="nam">to_native</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t108" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t109" class="pln">        <span class="com"># A temporary file (opened pre-fork) used by connection</span><span class="strut">&nbsp;</span></p>
<p id="t110" class="pln">        <span class="com"># plugins for inter-process locking.</span><span class="strut">&nbsp;</span></p>
<p id="t111" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_connection_lockfile</span> <span class="op">=</span> <span class="nam">tempfile</span><span class="op">.</span><span class="nam">TemporaryFile</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t112" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t113" class="stm run hide_run">    <span class="key">def</span> <span class="nam">_initialize_processes</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">num</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t114" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_workers</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t115" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t116" class="stm run hide_run">        <span class="key">for</span> <span class="nam">i</span> <span class="key">in</span> <span class="nam">range</span><span class="op">(</span><span class="nam">num</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t117" class="stm run hide_run">            <span class="nam">self</span><span class="op">.</span><span class="nam">_workers</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">None</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t118" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t119" class="stm run hide_run">    <span class="key">def</span> <span class="nam">_initialize_notified_handlers</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">play</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t120" class="pln">        <span class="str">'''</span><span class="strut">&nbsp;</span></p>
<p id="t121" class="pln"><span class="str">        Clears and initializes the shared notified handlers dict with entries</span><span class="strut">&nbsp;</span></p>
<p id="t122" class="pln"><span class="str">        for each handler in the play, which is an empty array that will contain</span><span class="strut">&nbsp;</span></p>
<p id="t123" class="pln"><span class="str">        inventory hostnames for those hosts triggering the handler.</span><span class="strut">&nbsp;</span></p>
<p id="t124" class="pln"><span class="str">        '''</span><span class="strut">&nbsp;</span></p>
<p id="t125" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t126" class="pln">        <span class="com"># Zero the dictionary first by removing any entries there.</span><span class="strut">&nbsp;</span></p>
<p id="t127" class="pln">        <span class="com"># Proxied dicts don't support iteritems, so we have to use keys()</span><span class="strut">&nbsp;</span></p>
<p id="t128" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_notified_handlers</span><span class="op">.</span><span class="nam">clear</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t129" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_listening_handlers</span><span class="op">.</span><span class="nam">clear</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t130" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t131" class="stm run hide_run">        <span class="key">def</span> <span class="nam">_process_block</span><span class="op">(</span><span class="nam">b</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t132" class="stm mis">            <span class="nam">temp_list</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t133" class="stm mis">            <span class="key">for</span> <span class="nam">t</span> <span class="key">in</span> <span class="nam">b</span><span class="op">.</span><span class="nam">block</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t134" class="stm mis">                <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">t</span><span class="op">,</span> <span class="nam">Block</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t135" class="stm mis">                    <span class="nam">temp_list</span><span class="op">.</span><span class="nam">extend</span><span class="op">(</span><span class="nam">_process_block</span><span class="op">(</span><span class="nam">t</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t136" class="pln">                <span class="key">else</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t137" class="stm mis">                    <span class="nam">temp_list</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">t</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t138" class="stm mis">            <span class="key">return</span> <span class="nam">temp_list</span><span class="strut">&nbsp;</span></p>
<p id="t139" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t140" class="stm run hide_run">        <span class="nam">handler_list</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t141" class="stm par run hide_run"><span class="annotate short">141&#x202F;&#x219B;&#x202F;142</span><span class="annotate long">line 141 didn't jump to line 142, because the loop on line 141 never started</span>        <span class="key">for</span> <span class="nam">handler_block</span> <span class="key">in</span> <span class="nam">play</span><span class="op">.</span><span class="nam">handlers</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t142" class="stm mis">            <span class="nam">handler_list</span><span class="op">.</span><span class="nam">extend</span><span class="op">(</span><span class="nam">_process_block</span><span class="op">(</span><span class="nam">handler_block</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t143" class="pln">        <span class="com"># then initialize it with the given handler list</span><span class="strut">&nbsp;</span></p>
<p id="t144" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">update_handler_list</span><span class="op">(</span><span class="nam">handler_list</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t145" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t146" class="stm run hide_run">    <span class="key">def</span> <span class="nam">update_handler_list</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">handler_list</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t147" class="stm par run hide_run"><span class="annotate short">147&#x202F;&#x219B;&#x202F;148</span><span class="annotate long">line 147 didn't jump to line 148, because the loop on line 147 never started</span>        <span class="key">for</span> <span class="nam">handler</span> <span class="key">in</span> <span class="nam">handler_list</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t148" class="stm mis">            <span class="key">if</span> <span class="nam">handler</span><span class="op">.</span><span class="nam">_uuid</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_notified_handlers</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t149" class="stm mis">                <span class="nam">display</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"Adding handler %s to notified list"</span> <span class="op">%</span> <span class="nam">handler</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t150" class="stm mis">                <span class="nam">self</span><span class="op">.</span><span class="nam">_notified_handlers</span><span class="op">[</span><span class="nam">handler</span><span class="op">.</span><span class="nam">_uuid</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t151" class="stm mis">            <span class="key">if</span> <span class="nam">handler</span><span class="op">.</span><span class="nam">listen</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t152" class="stm mis">                <span class="nam">listeners</span> <span class="op">=</span> <span class="nam">handler</span><span class="op">.</span><span class="nam">listen</span><span class="strut">&nbsp;</span></p>
<p id="t153" class="stm mis">                <span class="key">if</span> <span class="key">not</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">listeners</span><span class="op">,</span> <span class="nam">list</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t154" class="stm mis">                    <span class="nam">listeners</span> <span class="op">=</span> <span class="op">[</span><span class="nam">listeners</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t155" class="stm mis">                <span class="key">for</span> <span class="nam">listener</span> <span class="key">in</span> <span class="nam">listeners</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t156" class="stm mis">                    <span class="key">if</span> <span class="nam">listener</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_listening_handlers</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t157" class="stm mis">                        <span class="nam">self</span><span class="op">.</span><span class="nam">_listening_handlers</span><span class="op">[</span><span class="nam">listener</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t158" class="stm mis">                    <span class="nam">display</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"Adding handler %s to listening list"</span> <span class="op">%</span> <span class="nam">handler</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t159" class="stm mis">                    <span class="nam">self</span><span class="op">.</span><span class="nam">_listening_handlers</span><span class="op">[</span><span class="nam">listener</span><span class="op">]</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">handler</span><span class="op">.</span><span class="nam">_uuid</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t160" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t161" class="stm run hide_run">    <span class="key">def</span> <span class="nam">load_callbacks</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t162" class="pln">        <span class="str">'''</span><span class="strut">&nbsp;</span></p>
<p id="t163" class="pln"><span class="str">        Loads all available callbacks, with the exception of those which</span><span class="strut">&nbsp;</span></p>
<p id="t164" class="pln"><span class="str">        utilize the CALLBACK_TYPE option. When CALLBACK_TYPE is set to 'stdout',</span><span class="strut">&nbsp;</span></p>
<p id="t165" class="pln"><span class="str">        only one such callback plugin will be loaded.</span><span class="strut">&nbsp;</span></p>
<p id="t166" class="pln"><span class="str">        '''</span><span class="strut">&nbsp;</span></p>
<p id="t167" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t168" class="stm par run hide_run"><span class="annotate short">168&#x202F;&#x219B;&#x202F;169</span><span class="annotate long">line 168 didn't jump to line 169, because the condition on line 168 was never true</span>        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_callbacks_loaded</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t169" class="stm mis">            <span class="key">return</span><span class="strut">&nbsp;</span></p>
<p id="t170" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t171" class="stm run hide_run">        <span class="nam">stdout_callback_loaded</span> <span class="op">=</span> <span class="nam">False</span><span class="strut">&nbsp;</span></p>
<p id="t172" class="stm par run hide_run"><span class="annotate short">172&#x202F;&#x219B;&#x202F;175</span><span class="annotate long">line 172 didn't jump to line 175, because the condition on line 172 was never false</span>        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span> <span class="key">is</span> <span class="nam">None</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t173" class="stm run hide_run">            <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span> <span class="op">=</span> <span class="nam">C</span><span class="op">.</span><span class="nam">DEFAULT_STDOUT_CALLBACK</span><span class="strut">&nbsp;</span></p>
<p id="t174" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t175" class="stm par run hide_run"><span class="annotate short">175&#x202F;&#x219B;&#x202F;176</span><span class="annotate long">line 175 didn't jump to line 176, because the condition on line 175 was never true</span>        <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">,</span> <span class="nam">CallbackBase</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t176" class="stm mis">            <span class="nam">stdout_callback_loaded</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t177" class="stm par run hide_run"><span class="annotate short">177&#x202F;&#x219B;&#x202F;190</span><span class="annotate long">line 177 didn't jump to line 190, because the condition on line 177 was never false</span>        <span class="key">elif</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">,</span> <span class="nam">string_types</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t178" class="stm par run hide_run"><span class="annotate short">178&#x202F;&#x219B;&#x202F;179</span><span class="annotate long">line 178 didn't jump to line 179, because the condition on line 178 was never true</span>            <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">callback_loader</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t179" class="stm mis">                <span class="key">raise</span> <span class="nam">AnsibleError</span><span class="op">(</span><span class="str">"Invalid callback for stdout specified: %s"</span> <span class="op">%</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t180" class="pln">            <span class="key">else</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t181" class="stm run hide_run">                <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span> <span class="op">=</span> <span class="nam">callback_loader</span><span class="op">.</span><span class="nam">get</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t182" class="stm run hide_run">                <span class="key">try</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t183" class="stm run hide_run">                    <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">.</span><span class="nam">set_options</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t184" class="stm mis">                <span class="key">except</span> <span class="nam">AttributeError</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t185" class="stm mis">                    <span class="nam">display</span><span class="op">.</span><span class="nam">deprecated</span><span class="op">(</span><span class="str">"%s stdout callback, does not support setting 'options', it will work for now, "</span><span class="strut">&nbsp;</span></p>
<p id="t186" class="pln">                                       <span class="str">" but this will be required in the future and should be updated,"</span><span class="strut">&nbsp;</span></p>
<p id="t187" class="pln">                                       <span class="str">" see the 2.4 porting guide for details."</span> <span class="op">%</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">.</span><span class="nam">_load_name</span><span class="op">,</span> <span class="nam">version</span><span class="op">=</span><span class="str">"2.9"</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t188" class="stm run hide_run">                <span class="nam">stdout_callback_loaded</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t189" class="pln">        <span class="key">else</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t190" class="stm mis">            <span class="key">raise</span> <span class="nam">AnsibleError</span><span class="op">(</span><span class="str">"callback must be an instance of CallbackBase or the name of a callback plugin"</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t191" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t192" class="stm run hide_run">        <span class="key">for</span> <span class="nam">callback_plugin</span> <span class="key">in</span> <span class="nam">callback_loader</span><span class="op">.</span><span class="nam">all</span><span class="op">(</span><span class="nam">class_only</span><span class="op">=</span><span class="nam">True</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t193" class="stm run hide_run">            <span class="nam">callback_type</span> <span class="op">=</span> <span class="nam">getattr</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">,</span> <span class="str">'CALLBACK_TYPE'</span><span class="op">,</span> <span class="str">''</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t194" class="stm run hide_run">            <span class="nam">callback_needs_whitelist</span> <span class="op">=</span> <span class="nam">getattr</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">,</span> <span class="str">'CALLBACK_NEEDS_WHITELIST'</span><span class="op">,</span> <span class="nam">False</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t195" class="stm run hide_run">            <span class="op">(</span><span class="nam">callback_name</span><span class="op">,</span> <span class="nam">_</span><span class="op">)</span> <span class="op">=</span> <span class="nam">os</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">splitext</span><span class="op">(</span><span class="nam">os</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">basename</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">.</span><span class="nam">_original_path</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t196" class="stm run hide_run">            <span class="key">if</span> <span class="nam">callback_type</span> <span class="op">==</span> <span class="str">'stdout'</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t197" class="pln">                <span class="com"># we only allow one callback of type 'stdout' to be loaded,</span><span class="strut">&nbsp;</span></p>
<p id="t198" class="stm par run hide_run"><span class="annotate short">198&#x202F;&#x219B;&#x202F;199,&nbsp;&nbsp; 198&#x202F;&#x219B;&#x202F;200</span><span class="annotate long">2 missed branches: 1) line 198 didn't jump to line 199, because the condition on line 198 was never true, 2) line 198 didn't jump to line 200, because the condition on line 198 was never false</span>                <span class="key">if</span> <span class="nam">callback_name</span> <span class="op">!=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span> <span class="key">or</span> <span class="nam">stdout_callback_loaded</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t199" class="stm mis">                    <span class="key">continue</span><span class="strut">&nbsp;</span></p>
<p id="t200" class="stm mis">                <span class="nam">stdout_callback_loaded</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t201" class="stm par run hide_run"><span class="annotate short">201&#x202F;&#x219B;&#x202F;203</span><span class="annotate long">line 201 didn't jump to line 203, because the condition on line 201 was never true</span>            <span class="key">elif</span> <span class="nam">callback_name</span> <span class="op">==</span> <span class="str">'tree'</span> <span class="key">and</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_run_tree</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t202" class="pln">                <span class="com"># special case for ansible cli option</span><span class="strut">&nbsp;</span></p>
<p id="t203" class="stm mis">                <span class="key">pass</span><span class="strut">&nbsp;</span></p>
<p id="t204" class="stm run hide_run">            <span class="key">elif</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_run_additional_callbacks</span> <span class="key">or</span> <span class="op">(</span><span class="nam">callback_needs_whitelist</span> <span class="key">and</span> <span class="op">(</span><span class="strut">&nbsp;</span></p>
<p id="t205" class="pln">                    <span class="nam">C</span><span class="op">.</span><span class="nam">DEFAULT_CALLBACK_WHITELIST</span> <span class="key">is</span> <span class="nam">None</span> <span class="key">or</span> <span class="nam">callback_name</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">C</span><span class="op">.</span><span class="nam">DEFAULT_CALLBACK_WHITELIST</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t206" class="pln">                <span class="com"># 2.x plugins shipped with ansible should require whitelisting, older or non shipped should load automatically</span><span class="strut">&nbsp;</span></p>
<p id="t207" class="stm run hide_run">                <span class="key">continue</span><span class="strut">&nbsp;</span></p>
<p id="t208" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t209" class="stm run hide_run">            <span class="nam">callback_obj</span> <span class="op">=</span> <span class="nam">callback_plugin</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t210" class="stm run hide_run">            <span class="key">try</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t211" class="stm run hide_run">                <span class="nam">callback_obj</span><span class="op">.</span><span class="nam">set_options</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t212" class="stm mis">            <span class="key">except</span> <span class="nam">AttributeError</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t213" class="stm mis">                    <span class="nam">display</span><span class="op">.</span><span class="nam">deprecated</span><span class="op">(</span><span class="str">"%s callback, does not support setting 'options', it will work for now, "</span><span class="strut">&nbsp;</span></p>
<p id="t214" class="pln">                                       <span class="str">" but this will be required in the future and should be updated, "</span><span class="strut">&nbsp;</span></p>
<p id="t215" class="pln">                                       <span class="str">" see the 2.4 porting guide for details."</span> <span class="op">%</span> <span class="nam">callback_obj</span><span class="op">.</span><span class="nam">_load_name</span><span class="op">,</span> <span class="nam">version</span><span class="op">=</span><span class="str">"2.9"</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t216" class="stm run hide_run">            <span class="nam">self</span><span class="op">.</span><span class="nam">_callback_plugins</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">callback_obj</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t217" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t218" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_callbacks_loaded</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t219" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t220" class="stm run hide_run">    <span class="key">def</span> <span class="nam">run</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">play</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t221" class="pln">        <span class="str">'''</span><span class="strut">&nbsp;</span></p>
<p id="t222" class="pln"><span class="str">        Iterates over the roles/tasks in a play, using the given (or default)</span><span class="strut">&nbsp;</span></p>
<p id="t223" class="pln"><span class="str">        strategy for queueing tasks. The default is the linear strategy, which</span><span class="strut">&nbsp;</span></p>
<p id="t224" class="pln"><span class="str">        operates like classic Ansible by keeping all hosts in lock-step with</span><span class="strut">&nbsp;</span></p>
<p id="t225" class="pln"><span class="str">        a given task (meaning no hosts move on to the next task until all hosts</span><span class="strut">&nbsp;</span></p>
<p id="t226" class="pln"><span class="str">        are done with the current task).</span><span class="strut">&nbsp;</span></p>
<p id="t227" class="pln"><span class="str">        '''</span><span class="strut">&nbsp;</span></p>
<p id="t228" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t229" class="stm par run hide_run"><span class="annotate short">229&#x202F;&#x219B;&#x202F;230</span><span class="annotate long">line 229 didn't jump to line 230, because the condition on line 229 was never true</span>        <span class="key">if</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_callbacks_loaded</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t230" class="stm mis">            <span class="nam">self</span><span class="op">.</span><span class="nam">load_callbacks</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t231" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t232" class="stm run hide_run">        <span class="nam">all_vars</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_variable_manager</span><span class="op">.</span><span class="nam">get_vars</span><span class="op">(</span><span class="nam">play</span><span class="op">=</span><span class="nam">play</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t233" class="stm run hide_run">        <span class="nam">warn_if_reserved</span><span class="op">(</span><span class="nam">all_vars</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t234" class="stm run hide_run">        <span class="nam">templar</span> <span class="op">=</span> <span class="nam">Templar</span><span class="op">(</span><span class="nam">loader</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_loader</span><span class="op">,</span> <span class="nam">variables</span><span class="op">=</span><span class="nam">all_vars</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t235" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t236" class="stm run hide_run">        <span class="nam">new_play</span> <span class="op">=</span> <span class="nam">play</span><span class="op">.</span><span class="nam">copy</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t237" class="stm run hide_run">        <span class="nam">new_play</span><span class="op">.</span><span class="nam">post_validate</span><span class="op">(</span><span class="nam">templar</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t238" class="stm run hide_run">        <span class="nam">new_play</span><span class="op">.</span><span class="nam">handlers</span> <span class="op">=</span> <span class="nam">new_play</span><span class="op">.</span><span class="nam">compile_roles_handlers</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="nam">new_play</span><span class="op">.</span><span class="nam">handlers</span><span class="strut">&nbsp;</span></p>
<p id="t239" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t240" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">hostvars</span> <span class="op">=</span> <span class="nam">HostVars</span><span class="op">(</span><span class="strut">&nbsp;</span></p>
<p id="t241" class="pln">            <span class="nam">inventory</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_inventory</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t242" class="pln">            <span class="nam">variable_manager</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_variable_manager</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t243" class="pln">            <span class="nam">loader</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_loader</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t244" class="pln">        <span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t245" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t246" class="stm run hide_run">        <span class="nam">play_context</span> <span class="op">=</span> <span class="nam">PlayContext</span><span class="op">(</span><span class="nam">new_play</span><span class="op">,</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_options</span><span class="op">,</span> <span class="nam">self</span><span class="op">.</span><span class="nam">passwords</span><span class="op">,</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_connection_lockfile</span><span class="op">.</span><span class="nam">fileno</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t247" class="stm run hide_run">        <span class="key">for</span> <span class="nam">callback_plugin</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_callback_plugins</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t248" class="stm par run hide_run"><span class="annotate short">248&#x202F;&#x219B;&#x202F;247</span><span class="annotate long">line 248 didn't jump to line 247, because the condition on line 248 was never false</span>            <span class="key">if</span> <span class="nam">hasattr</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">,</span> <span class="str">'set_play_context'</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t249" class="stm run hide_run">                <span class="nam">callback_plugin</span><span class="op">.</span><span class="nam">set_play_context</span><span class="op">(</span><span class="nam">play_context</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t250" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t251" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">send_callback</span><span class="op">(</span><span class="str">'v2_playbook_on_play_start'</span><span class="op">,</span> <span class="nam">new_play</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t252" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t253" class="pln">        <span class="com"># initialize the shared dictionary containing the notified handlers</span><span class="strut">&nbsp;</span></p>
<p id="t254" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_initialize_notified_handlers</span><span class="op">(</span><span class="nam">new_play</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t255" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t256" class="pln">        <span class="com"># build the iterator</span><span class="strut">&nbsp;</span></p>
<p id="t257" class="stm run hide_run">        <span class="nam">iterator</span> <span class="op">=</span> <span class="nam">PlayIterator</span><span class="op">(</span><span class="strut">&nbsp;</span></p>
<p id="t258" class="pln">            <span class="nam">inventory</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_inventory</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t259" class="pln">            <span class="nam">play</span><span class="op">=</span><span class="nam">new_play</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t260" class="pln">            <span class="nam">play_context</span><span class="op">=</span><span class="nam">play_context</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t261" class="pln">            <span class="nam">variable_manager</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_variable_manager</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t262" class="pln">            <span class="nam">all_vars</span><span class="op">=</span><span class="nam">all_vars</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t263" class="pln">            <span class="nam">start_at_done</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">_start_at_done</span><span class="op">,</span><span class="strut">&nbsp;</span></p>
<p id="t264" class="pln">        <span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t265" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t266" class="pln">        <span class="com"># adjust to # of workers to configured forks or size of batch, whatever is lower</span><span class="strut">&nbsp;</span></p>
<p id="t267" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_initialize_processes</span><span class="op">(</span><span class="nam">min</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">_options</span><span class="op">.</span><span class="nam">forks</span><span class="op">,</span> <span class="nam">iterator</span><span class="op">.</span><span class="nam">batch_size</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t268" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t269" class="pln">        <span class="com"># load the specified strategy (or the default linear one)</span><span class="strut">&nbsp;</span></p>
<p id="t270" class="stm run hide_run">        <span class="nam">strategy</span> <span class="op">=</span> <span class="nam">strategy_loader</span><span class="op">.</span><span class="nam">get</span><span class="op">(</span><span class="nam">new_play</span><span class="op">.</span><span class="nam">strategy</span><span class="op">,</span> <span class="nam">self</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t271" class="stm par run hide_run"><span class="annotate short">271&#x202F;&#x219B;&#x202F;272</span><span class="annotate long">line 271 didn't jump to line 272, because the condition on line 271 was never true</span>        <span class="key">if</span> <span class="nam">strategy</span> <span class="key">is</span> <span class="nam">None</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t272" class="stm mis">            <span class="key">raise</span> <span class="nam">AnsibleError</span><span class="op">(</span><span class="str">"Invalid play strategy specified: %s"</span> <span class="op">%</span> <span class="nam">new_play</span><span class="op">.</span><span class="nam">strategy</span><span class="op">,</span> <span class="nam">obj</span><span class="op">=</span><span class="nam">play</span><span class="op">.</span><span class="nam">_ds</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t273" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t274" class="pln">        <span class="com"># Because the TQM may survive multiple play runs, we start by marking</span><span class="strut">&nbsp;</span></p>
<p id="t275" class="pln">        <span class="com"># any hosts as failed in the iterator here which may have been marked</span><span class="strut">&nbsp;</span></p>
<p id="t276" class="pln">        <span class="com"># as failed in previous runs. Then we clear the internal list of failed</span><span class="strut">&nbsp;</span></p>
<p id="t277" class="pln">        <span class="com"># hosts so we know what failed this round.</span><span class="strut">&nbsp;</span></p>
<p id="t278" class="stm par run hide_run"><span class="annotate short">278&#x202F;&#x219B;&#x202F;279</span><span class="annotate long">line 278 didn't jump to line 279, because the loop on line 278 never started</span>        <span class="key">for</span> <span class="nam">host_name</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_failed_hosts</span><span class="op">.</span><span class="nam">keys</span><span class="op">(</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t279" class="stm mis">            <span class="nam">host</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_inventory</span><span class="op">.</span><span class="nam">get_host</span><span class="op">(</span><span class="nam">host_name</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t280" class="stm mis">            <span class="nam">iterator</span><span class="op">.</span><span class="nam">mark_host_failed</span><span class="op">(</span><span class="nam">host</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t281" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t282" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">clear_failed_hosts</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t283" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t284" class="pln">        <span class="com"># during initialization, the PlayContext will clear the start_at_task</span><span class="strut">&nbsp;</span></p>
<p id="t285" class="pln">        <span class="com"># field to signal that a matching task was found, so check that here</span><span class="strut">&nbsp;</span></p>
<p id="t286" class="pln">        <span class="com"># and remember it so we don't try to skip tasks on future plays</span><span class="strut">&nbsp;</span></p>
<p id="t287" class="stm par run hide_run"><span class="annotate short">287&#x202F;&#x219B;&#x202F;288</span><span class="annotate long">line 287 didn't jump to line 288, because the condition on line 287 was never true</span>        <span class="key">if</span> <span class="nam">getattr</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">_options</span><span class="op">,</span> <span class="str">'start_at_task'</span><span class="op">,</span> <span class="nam">None</span><span class="op">)</span> <span class="key">is</span> <span class="key">not</span> <span class="nam">None</span> <span class="key">and</span> <span class="nam">play_context</span><span class="op">.</span><span class="nam">start_at_task</span> <span class="key">is</span> <span class="nam">None</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t288" class="stm mis">            <span class="nam">self</span><span class="op">.</span><span class="nam">_start_at_done</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t289" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t290" class="pln">        <span class="com"># and run the play using the strategy and cleanup on way out</span><span class="strut">&nbsp;</span></p>
<p id="t291" class="stm run hide_run">        <span class="nam">play_return</span> <span class="op">=</span> <span class="nam">strategy</span><span class="op">.</span><span class="nam">run</span><span class="op">(</span><span class="nam">iterator</span><span class="op">,</span> <span class="nam">play_context</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t292" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t293" class="pln">        <span class="com"># now re-save the hosts that failed from the iterator to our internal list</span><span class="strut">&nbsp;</span></p>
<p id="t294" class="stm run hide_run">        <span class="key">for</span> <span class="nam">host_name</span> <span class="key">in</span> <span class="nam">iterator</span><span class="op">.</span><span class="nam">get_failed_hosts</span><span class="op">(</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t295" class="stm run hide_run">            <span class="nam">self</span><span class="op">.</span><span class="nam">_failed_hosts</span><span class="op">[</span><span class="nam">host_name</span><span class="op">]</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t296" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t297" class="stm run hide_run">        <span class="nam">strategy</span><span class="op">.</span><span class="nam">cleanup</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t298" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_cleanup_processes</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t299" class="stm run hide_run">        <span class="key">return</span> <span class="nam">play_return</span><span class="strut">&nbsp;</span></p>
<p id="t300" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t301" class="stm run hide_run">    <span class="key">def</span> <span class="nam">cleanup</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t302" class="stm run hide_run">        <span class="nam">display</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"RUNNING CLEANUP"</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t303" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">terminate</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t304" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_final_q</span><span class="op">.</span><span class="nam">close</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t305" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_cleanup_processes</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t306" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t307" class="stm run hide_run">    <span class="key">def</span> <span class="nam">_cleanup_processes</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t308" class="stm par run hide_run"><span class="annotate short">308&#x202F;&#x219B;&#x202F;exit</span><span class="annotate long">line 308 didn't return from function '_cleanup_processes', because the condition on line 308 was never false</span>        <span class="key">if</span> <span class="nam">hasattr</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="str">'_workers'</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t309" class="stm run hide_run">            <span class="key">for</span> <span class="nam">worker_prc</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_workers</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t310" class="stm par run hide_run"><span class="annotate short">310&#x202F;&#x219B;&#x202F;311</span><span class="annotate long">line 310 didn't jump to line 311, because the condition on line 310 was never true</span>                <span class="key">if</span> <span class="nam">worker_prc</span> <span class="key">and</span> <span class="nam">worker_prc</span><span class="op">.</span><span class="nam">is_alive</span><span class="op">(</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t311" class="stm mis">                    <span class="key">try</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t312" class="stm mis">                        <span class="nam">worker_prc</span><span class="op">.</span><span class="nam">terminate</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t313" class="stm mis">                    <span class="key">except</span> <span class="nam">AttributeError</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t314" class="stm mis">                        <span class="key">pass</span><span class="strut">&nbsp;</span></p>
<p id="t315" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t316" class="stm run hide_run">    <span class="key">def</span> <span class="nam">clear_failed_hosts</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t317" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_failed_hosts</span> <span class="op">=</span> <span class="nam">dict</span><span class="op">(</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t318" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t319" class="stm run hide_run">    <span class="key">def</span> <span class="nam">get_inventory</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t320" class="stm run hide_run">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_inventory</span><span class="strut">&nbsp;</span></p>
<p id="t321" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t322" class="stm run hide_run">    <span class="key">def</span> <span class="nam">get_variable_manager</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t323" class="stm run hide_run">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_variable_manager</span><span class="strut">&nbsp;</span></p>
<p id="t324" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t325" class="stm run hide_run">    <span class="key">def</span> <span class="nam">get_loader</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t326" class="stm run hide_run">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_loader</span><span class="strut">&nbsp;</span></p>
<p id="t327" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t328" class="stm run hide_run">    <span class="key">def</span> <span class="nam">get_workers</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t329" class="stm run hide_run">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_workers</span><span class="op">[</span><span class="op">:</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t330" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t331" class="stm run hide_run">    <span class="key">def</span> <span class="nam">terminate</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t332" class="stm run hide_run">        <span class="nam">self</span><span class="op">.</span><span class="nam">_terminated</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t333" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t334" class="stm run hide_run">    <span class="key">def</span> <span class="nam">has_dead_workers</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t335" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t336" class="pln">        <span class="com"># [&lt;WorkerProcess(WorkerProcess-2, stopped[SIGKILL])>,</span><span class="strut">&nbsp;</span></p>
<p id="t337" class="pln">        <span class="com"># &lt;WorkerProcess(WorkerProcess-2, stopped[SIGTERM])></span><span class="strut">&nbsp;</span></p>
<p id="t338" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t339" class="stm run hide_run">        <span class="nam">defunct</span> <span class="op">=</span> <span class="nam">False</span><span class="strut">&nbsp;</span></p>
<p id="t340" class="stm run hide_run">        <span class="key">for</span> <span class="op">(</span><span class="nam">idx</span><span class="op">,</span> <span class="nam">x</span><span class="op">)</span> <span class="key">in</span> <span class="nam">enumerate</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">_workers</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t341" class="stm par run hide_run"><span class="annotate short">341&#x202F;&#x219B;&#x202F;342</span><span class="annotate long">line 341 didn't jump to line 342, because the condition on line 341 was never true</span>            <span class="key">if</span> <span class="nam">hasattr</span><span class="op">(</span><span class="nam">x</span><span class="op">,</span> <span class="str">'exitcode'</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t342" class="stm mis">                <span class="key">if</span> <span class="nam">x</span><span class="op">.</span><span class="nam">exitcode</span> <span class="key">in</span> <span class="op">[</span><span class="op">-</span><span class="num">9</span><span class="op">,</span> <span class="op">-</span><span class="num">11</span><span class="op">,</span> <span class="op">-</span><span class="num">15</span><span class="op">]</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t343" class="stm mis">                    <span class="nam">defunct</span> <span class="op">=</span> <span class="nam">True</span><span class="strut">&nbsp;</span></p>
<p id="t344" class="stm run hide_run">        <span class="key">return</span> <span class="nam">defunct</span><span class="strut">&nbsp;</span></p>
<p id="t345" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t346" class="stm run hide_run">    <span class="key">def</span> <span class="nam">send_callback</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">method_name</span><span class="op">,</span> <span class="op">*</span><span class="nam">args</span><span class="op">,</span> <span class="op">**</span><span class="nam">kwargs</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t347" class="stm run hide_run">        <span class="key">for</span> <span class="nam">callback_plugin</span> <span class="key">in</span> <span class="op">[</span><span class="nam">self</span><span class="op">.</span><span class="nam">_stdout_callback</span><span class="op">]</span> <span class="op">+</span> <span class="nam">self</span><span class="op">.</span><span class="nam">_callback_plugins</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t348" class="pln">            <span class="com"># a plugin that set self.disabled to True will not be called</span><span class="strut">&nbsp;</span></p>
<p id="t349" class="pln">            <span class="com"># see osx_say.py example for such a plugin</span><span class="strut">&nbsp;</span></p>
<p id="t350" class="stm run hide_run">            <span class="key">if</span> <span class="nam">getattr</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">,</span> <span class="str">'disabled'</span><span class="op">,</span> <span class="nam">False</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t351" class="stm run hide_run">                <span class="key">continue</span><span class="strut">&nbsp;</span></p>
<p id="t352" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t353" class="pln">            <span class="com"># try to find v2 method, fallback to v1 method, ignore callback if no method found</span><span class="strut">&nbsp;</span></p>
<p id="t354" class="stm run hide_run">            <span class="nam">methods</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t355" class="stm run hide_run">            <span class="key">for</span> <span class="nam">possible</span> <span class="key">in</span> <span class="op">[</span><span class="nam">method_name</span><span class="op">,</span> <span class="str">'v2_on_any'</span><span class="op">]</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t356" class="stm run hide_run">                <span class="nam">gotit</span> <span class="op">=</span> <span class="nam">getattr</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">,</span> <span class="nam">possible</span><span class="op">,</span> <span class="nam">None</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t357" class="stm par run hide_run"><span class="annotate short">357&#x202F;&#x219B;&#x202F;358</span><span class="annotate long">line 357 didn't jump to line 358, because the condition on line 357 was never true</span>                <span class="key">if</span> <span class="nam">gotit</span> <span class="key">is</span> <span class="nam">None</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t358" class="stm mis">                    <span class="nam">gotit</span> <span class="op">=</span> <span class="nam">getattr</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">,</span> <span class="nam">possible</span><span class="op">.</span><span class="nam">replace</span><span class="op">(</span><span class="str">'v2_'</span><span class="op">,</span> <span class="str">''</span><span class="op">)</span><span class="op">,</span> <span class="nam">None</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t359" class="stm par run hide_run"><span class="annotate short">359&#x202F;&#x219B;&#x202F;355</span><span class="annotate long">line 359 didn't jump to line 355, because the condition on line 359 was never false</span>                <span class="key">if</span> <span class="nam">gotit</span> <span class="key">is</span> <span class="key">not</span> <span class="nam">None</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t360" class="stm run hide_run">                    <span class="nam">methods</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">gotit</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t361" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t362" class="pln">            <span class="com"># send clean copies</span><span class="strut">&nbsp;</span></p>
<p id="t363" class="stm run hide_run">            <span class="nam">new_args</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span><span class="strut">&nbsp;</span></p>
<p id="t364" class="stm run hide_run">            <span class="key">for</span> <span class="nam">arg</span> <span class="key">in</span> <span class="nam">args</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t365" class="pln">                <span class="com"># FIXME: add play/task cleaners</span><span class="strut">&nbsp;</span></p>
<p id="t366" class="stm run hide_run">                <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">arg</span><span class="op">,</span> <span class="nam">TaskResult</span><span class="op">)</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t367" class="stm run hide_run">                    <span class="nam">new_args</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">arg</span><span class="op">.</span><span class="nam">clean_copy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t368" class="pln">                <span class="com"># elif isinstance(arg, Play):</span><span class="strut">&nbsp;</span></p>
<p id="t369" class="pln">                <span class="com"># elif isinstance(arg, Task):</span><span class="strut">&nbsp;</span></p>
<p id="t370" class="pln">                <span class="key">else</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t371" class="stm run hide_run">                    <span class="nam">new_args</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">arg</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t372" class="pln"><span class="strut">&nbsp;</span></p>
<p id="t373" class="stm run hide_run">            <span class="key">for</span> <span class="nam">method</span> <span class="key">in</span> <span class="nam">methods</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t374" class="stm run hide_run">                <span class="key">try</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t375" class="stm run hide_run">                    <span class="nam">method</span><span class="op">(</span><span class="op">*</span><span class="nam">new_args</span><span class="op">,</span> <span class="op">**</span><span class="nam">kwargs</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t376" class="stm mis">                <span class="key">except</span> <span class="nam">Exception</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span><span class="strut">&nbsp;</span></p>
<p id="t377" class="pln">                    <span class="com"># TODO: add config toggle to make this fatal or not?</span><span class="strut">&nbsp;</span></p>
<p id="t378" class="stm mis">                    <span class="nam">display</span><span class="op">.</span><span class="nam">warning</span><span class="op">(</span><span class="str">u"Failure using method (%s) in callback plugin (%s): %s"</span> <span class="op">%</span> <span class="op">(</span><span class="nam">to_text</span><span class="op">(</span><span class="nam">method_name</span><span class="op">)</span><span class="op">,</span> <span class="nam">to_text</span><span class="op">(</span><span class="nam">callback_plugin</span><span class="op">)</span><span class="op">,</span> <span class="nam">to_text</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>
<p id="t379" class="stm mis">                    <span class="key">from</span> <span class="nam">traceback</span> <span class="key">import</span> <span class="nam">format_tb</span><span class="strut">&nbsp;</span></p>
<p id="t380" class="stm mis">                    <span class="key">from</span> <span class="nam">sys</span> <span class="key">import</span> <span class="nam">exc_info</span><span class="strut">&nbsp;</span></p>
<p id="t381" class="stm mis">                    <span class="nam">display</span><span class="op">.</span><span class="nam">vvv</span><span class="op">(</span><span class="str">'Callback Exception: \n'</span> <span class="op">+</span> <span class="str">' '</span><span class="op">.</span><span class="nam">join</span><span class="op">(</span><span class="nam">format_tb</span><span class="op">(</span><span class="nam">exc_info</span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="strut">&nbsp;</span></p>

            </td>
        </tr>
    </table>
</div>

<div id="footer">
    <div class="content">
        <p>
            <a class="nav" href="index.html">&#xab; index</a> &nbsp; &nbsp; <a class="nav" href="https://coverage.readthedocs.io">coverage.py v4.5.2</a>,
            created at 2019-05-13 15:45
        </p>
    </div>
</div>

</body>
</html>
